function OnboardOverlayStep(elementId,utmCode,title,content,positioning,leftOffset,topOffset){if(typeof leftOffset==='undefined'){leftOffset=0;}
if(typeof topOffset==='undefined'){topOffset=0;}
this.elementId=elementId;this.utmCode=utmCode;this.title=title;this.content=content;this.positioning=positioning;this.leftOffset=leftOffset;this.topOffset=topOffset;}
function OnboardOverlay(steps){this.currentStep=-1;this.steps=steps;this.addPagination();$("#on-board-next").on("click",$.proxy(this.next,this));$("#on-board-skip").on("click",$.proxy(this.end,this));$(".step-to").on("click",$.proxy(this.onClickPagination,this));this.start();}
OnboardOverlay.prototype.start=function(){$("html, body").animate({scrollTop:"0px"});$(".on-board-overlay").css({"display":"block"});$("body").addClass("modal-open");$(".on-board-tooltip .btn").attr('href','#'+this.getUtmParams('start'));$(".on-board-tooltip #on-board-skip").attr('href','#'+this.getUtmParams('exit'));document.location.hash=this.getUtmParams('start');$(window).resize($.proxy(function(){this.updatePosition();},this));};OnboardOverlay.prototype.onClickPagination=function(e){var step=parseInt(e.currentTarget.dataset.stepId);if(step<this.steps.length&&step>=0){this.currentStep=step;this.stepTo(this.currentStep);}};OnboardOverlay.prototype.getUtmParams=function(action){var step=this.steps[this.currentStep]||{};if(this.currentStep===-1){step.utmCode='welcome';}
return'utm_campaign='+escape((this.currentStep+1)+'-'+step.utmCode+'-'+action)+'&utm_source=onboard&utm_medium=popup&utm_content='+pageContext.currentUser.username;};OnboardOverlay.prototype.track=function(){var gat=_gat._createTracker("UA-399680-1");gat._setAllowAnchor(true);gat._trackPageview();};OnboardOverlay.prototype.next=function(){if(this.currentStep+1<this.steps.length){this.currentStep++;this.stepTo(this.currentStep);}};OnboardOverlay.prototype.end=function(e){$(".on-board-overlay").css({"display":"none"});var _this=this;if(this.currentStep==(this.steps.length-1)){$.get("/splunk/rewardOnboardKarma.json");}
try{$(".on-board-overlay").remove();$("body").removeClass("modal-open");setTimeout(function(){_this.track();},500);}catch(err){console.log("error removing on-boarding overlay");}};OnboardOverlay.prototype.stepTo=function(stepNumber){$(".on-board-pagination").css({"display":"block"});var step=this.steps[stepNumber];var position=$(step.elementId).offset();this.updatePosition();$(".on-board-pagination .step-to").removeClass("active");$($(".on-board-pagination .step-to")[stepNumber]).addClass("active");$(".on-board-tooltip .title").html(step.title);$(".on-board-tooltip .content").html(step.content);if($(".on-board-tooltip .btn").text().trim()=="Get Started"){$(".on-board-tooltip .btn").html("Next");}
$(".on-board-tooltip #on-board-skip").attr('href','#'+this.getUtmParams('exit'));if(stepNumber==this.steps.length-1){$(".on-board-tooltip .btn").html("I'm Ready!").attr('href','#'+this.getUtmParams('ready'));$(".on-board-tooltip .gray-link").css("visibility","hidden");$("#on-board-next").off("click",$.proxy(this.next,this));$("#on-board-next").off("click",$.proxy(this.end,this));$("#on-board-next").on("click",$.proxy(this.end,this));}else{$(".on-board-tooltip .btn").html("Next").attr('href','#'+this.getUtmParams('next'));$(".on-board-tooltip .gray-link").css("visibility","visible");$("#on-board-next").off("click",$.proxy(this.next,this));$("#on-board-next").off("click",$.proxy(this.end,this));$("#on-board-next").on("click",$.proxy(this.next,this));}};OnboardOverlay.prototype.updatePosition=function(){var step=this.steps[this.currentStep];if(typeof step==='undefined'){return false;}
var $el=$(step.elementId);var position=$el.offset();var leftOffset=position.left+$(step.elementId).width()/2;var topOffset=position.top+$(step.elementId).height()/2;leftOffset=leftOffset+step.leftOffset;topOffset=topOffset+step.topOffset;$(".on-board-tooltip").removeClass("top").removeClass("bottom").removeClass("left").removeClass("start");$(".on-board-tooltip").addClass(step.positioning);var marginLeft="-617px";var bottomBoxMarginLeft="-415px";if(($(window).width()>768)&&($(window).width()<=990)){marginLeft="-520px";bottomBoxMarginLeft="-315px";}
switch(step.positioning){case"top":$(".on-board-tooltip").css({"left":leftOffset+"px","top":topOffset+"px","margin-top":"-390px","margin-left":"-45px",});break;case"bottom":$(".on-board-tooltip").css({"left":leftOffset+"px","top":topOffset+"px","margin-top":"150px","margin-left":bottomBoxMarginLeft});break;case"left":$(".on-board-tooltip").css({"left":leftOffset+"px","top":topOffset+"px","margin-top":"-45px","margin-left":marginLeft,});break;default:break;}
if($(window).width()<768){$(".on-board-overlay").css({"background-position":"-300px "+"-300px"});}else{var bgLeftPos=leftOffset-step.leftOffset;$(".on-board-overlay").css({"background-position":(bgLeftPos)+"px "+(topOffset)+"px"});}
if(step.utmCode==='browse'){$(".on-board-tooltip").css('width','550px');}else{$(".on-board-tooltip").css('width','');}
this.track();return true;};OnboardOverlay.prototype.addPagination=function(){for(var i=0;i<this.steps.length;i++){$(".on-board-pagination").append("<span class='step-to' data-step-id='"+i+"'></span>");}};var step1=new OnboardOverlayStep(".navbar-search .search-query",'search',"Search For Questions",'Search for your question before you ask! Other users may have asked a question about the same problem and already received a perfect answer for you. Be sure to include key technical terms that are specific to Splunk for the best relevant results. Use the <a href="http://docs.splunk.com/Splexicon" target="_blank">Splexicon</a> for reference.',"left");var step2=new OnboardOverlayStep(".mainContent .sort li:contains('Newest')",'browse',"Browse Popular Answers","You can view the most popular and latest posts to see what topics are trending in the Splunk community. This is a good way to stay up to date with hot issues, and to find opportunities to share your knowledge by helping answer questions for other users.","top");var step3=new OnboardOverlayStep(".header-tabs #nav-ask",'ask',"Ask Questions","If you can't find the right answer after searching previous posts, you can ask your own question! Best practices are: ask one question per post, be as detailed as possible, anonymize private data, use the text editor tools for proper formatting, tag relevant Splunk terms, and accept an answer if it solved your problem.","left");var step4=new OnboardOverlayStep("#id_login_status .current-score-positive",'karma',"Karma Points","Karma points are a rough measurement of your reputation in the Splunk community. You earn points when users accept your answers to their questions, or upvote your thoughtful questions, answers, and comments. Upvote any posts that are helpful and be respectful!","bottom",0);var step5=new OnboardOverlayStep(".header-tabs #nav-users",'leaderboard',"Leaderboard","See how your karma level helps you rise in the ranks of the Splunk community as a trustworthy source. Keep on the lookout for periodic contests on Splunk Answers to see how your leaderboard position can win you an awesome prize!","left");var steps=[step1,step2,step3,step4,step5];$(document).ready(function(){if(window.location&&(/^(?:\/)$/g.test(window.location.pathname)||window.location.pathname==='')){if(typeof user_data==='string'&&user_data.trim()!==''){var onboardOverlay=new OnboardOverlay(steps);}}});(function($){var SplunkMeToo=function(){var _request=function(data,scope,cbk){$.ajax({url:'/'+scope.options.nodeId+'/metoo.json',dataType:'json',context:scope,data:data,cache:false,complete:function(ret){cbk.call(this,ret);}});};this.$container=null;this.options={idContainer:'.post.question',enabled:false,statsContainer:'.metoo-stats',onClick:function(opts){var _this=this;_request({update:true,stats:false},_this,function(ret){if(ret.responseJSON.result&&ret.responseJSON.result.metoo){this.enable();}else if(ret.responseJSON.result&&ret.responseJSON.result.metoo===false){this.disable();}
this.stats(ret);});}};this.init=function(options){if(this.options!==null){var $metoo=jQuery('<div class="metoo" />');var _this=this;var $btn=jQuery('<a href="javascript:void(0)" class="metoo-btn" />');if(window.location.href.indexOf('beta')===-1){$btn.html('<span>ME TOO</span>');}else{$btn.append('me too');}
$btn.click(function(){_this.options.onClick.apply(_this,Array.prototype.concat.call(_this.options,arguments));});$metoo.append($btn);this.$container.find('.metoo').remove();this.$container.append($metoo);this.stats();}};this.enable=function(){this.$container.find('.metoo-btn').addClass('metoo-active');};this.disable=function(){this.$container.find('.metoo-btn').removeClass('metoo-active');$('.metoo-btn').blur();};this.stats=function(ret){var stats=this.$container.parent('.post').find(this.options.statsContainer);if(typeof ret==='undefined'||ret===null){_request({update:false},this,function(ret){if(ret.responseJSON.result&&ret.responseJSON.result.stats){stats.text(ret.responseJSON.result.msg);if(typeof ret.responseJSON.result.metoo!=='undefined'&&ret.responseJSON.result.metoo){this.enable();}else{this.disable();}}});}else{if(ret.responseJSON.result&&ret.responseJSON.result.stats){stats.text(ret.responseJSON.result.msg);}else{stats.empty();}}};};$.fn.metoo=function(opts){var metoo=new SplunkMeToo();metoo.options=typeof opts==='object'?$.extend({},metoo.options,opts):metoo.options;metoo.$container=this;if(typeof metoo.$container.attr('nodeId')!=='undefined'){metoo.options.nodeId=metoo.$container.attr('nodeId');}else if(metoo.$container.parent(metoo.options.idContainer).length>0){metoo.options.nodeId=metoo.$container.parent(metoo.options.idContainer).attr('id').replace(/[^\d]+/gi,'$');}
if(typeof opts==='object'||typeof opts==='undefined'){metoo.init.call(metoo,metoo.options);}else if(typeof opts==='string'&&typeof metoo[opts]==='function'){metoo[opts].apply(metoo,Array.prototype.slice.call(arguments,1));}
return this;};}(jQuery));